#pragma once

#include "YoshiPBR/ysTypes.h"

struct ysJob;
struct ysJobSystem;

typedef void ysJobFcn(ysJobSystem*, ysJob*, void* args);

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
struct ysJobDef
{
    ysJobDef()
    {
        m_fcn = nullptr;
        m_fcnArg = nullptr;
        m_parentJob = nullptr;
    }

    ysJobFcn* m_fcn;
    void* m_fcnArg;
    ysJob* m_parentJob;
};

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
struct ysJobSystemDef
{
    ysJobSystemDef()
    {
        m_workerCount = 1;
    }

    ys_int32 m_workerCount;
};

ysJobSystem* ysJobSystem_Create(const ysJobSystemDef&);
void ysJobSystem_Destroy(ysJobSystem*);

ysJob* ysJobSystem_CreateJob(ysJobSystem*, const ysJobDef&);
void ysJobSystem_DestroyJob(ysJobSystem*, ysJob*);

void ysJobSystem_SubmitJob(ysJobSystem*, ysJob*);
void ysJobSystem_WaitOnJob(ysJobSystem*, ysJob*);